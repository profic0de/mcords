import sys; import os; sys.path.append(os.path.abspath(os.path.join(os.path.dirname(__file__), '..'))); del sys, os

from server.tools import Tool

compare = [
    b'\x81\x04\xb4\x0cx\x9cu\x94\xcb\x92\xd40\x0cE\xb3c\t\x0c\xf3\x00\xa6\xa6(\xe6\x07\xd8\xb3\xe3K\\\xeaX\x9dx\xda\xaf\x92\x9c\xb8\x9a\xaf\xc7\x8d\x93j\xb9\x93\xd9\x9ek\xcb\xd7\xd2\xb5?|u\xc6cOpL\xbfs \xab\x07\xf4\xbf\x0e&8\xfcswU\x0e\xa0-x\xcd\xdd\x93d\xee\x10\x82z\x9b\xfc`\xb1\x15\x18lR\x1am\x02\xee>\n\x01\xa1\x1f\xbbG\x01\x0c\xf5\xa3:\x06BN\x92\xf7#\x12\x9d\xd5@a\xc6\xee^\xf0`\xb5\n=\x82\xef\x84\xed\x9e\x8c\xe3\xe0\xd7:\x0fWE\x03\x9dV\xfcM`\xc4\xa8D\xad/7\xd2e[\xf7|\x03\x8f\x14\xfe\xa2_v\xbc\xdc\x88v:a\x06r\x8b|\x7f#W\xfaIRFj=\x91\x89\x9c\x82G\xd5\xc3\x8c,o\x81^\xab\x03\x10\xa1o\xfa\x7f\xc1\xa3\x19\xc6:\x98\xc7Vpf\x19\x988\x02)h\xbc\x94\xda\xce\xf2hCFZ[%\x8cng\xd3\xf4a\xcb#\xc2\x89w8\x99\x19I\x86a3\\\xd3\xa3\xe2hN\xd8l\x7f\x83a(\xa6kYal\x89\x9d\x88\xc1\xfb3\xb0\x13\x8fK[\xc5z\x07\xfe\xbf\x07\xc5\x19\\\x94\xb5\x1d\x82\x0eY\xb6\xce\x95\n\x14\x82SG\x83\xb6m\x9d\xc7T\xd2\xaa2p\xc2&\xed\xd5\xc6O\x01J\xe0\xca\x899\x8d\xaa\t\xfe\x8f\xdd%\xb1@\x95\xc0\x0c\xf0N\r\x8e4\xf5\xeb\x12\x11\x97\x08\x16\xd5\x00\xa4\xb1\x89\\\xb4`|c\xb0\x8e\xe4\xf3\x150\xcc\xe0=\xc8\x8b/H\x95\xdd\ta\x92\xaf\x82\x1dX\xab.a3\\\x03%L\xb0\x0f\xf9\xac6\x0f\xbe\xe2\xc5\xca\x86\xb3\r\x11w\xca\xd4+~\x178LVq9S\xcd\xc5\x03\x9e\xe5<8\x021\xae\xdf\x92\xacU^\xd7y\t\xd2\x06\xf3Xf\xd1\x1c1\xf9\xe5Ql\x1bW\x03#@5(:Y"q\xe9Lw\xd7\xa29\x18-\x83)\xe2\xfa\xd4\xd0X"\xbf\xa4Cx\xca\xa6t9cL\xab\xf6\xba\xa7\rT\x92n\xed\xb9|\x0e\xd66\x1f\xc0uM\x95\x9e\xf7\xa4\x9d\x10\xe4\xd0~\x1c\xff\x00\xf0dU!\xe1\x01\x00\x07\x13minecraft:chat_type\x07\x0eminecraft:chat\x00\x17minecraft:emote_command\x00\x1eminecraft:msg_command_incoming\x00\x1eminecraft:msg_command_outgoing\x00\x15minecraft:say_command\x00#minecraft:team_msg_command_incoming\x00#minecraft:team_msg_command_outgoing\x00'
]
uncompresed = [
    b'\xb4\x0c\x07\x18minecraft:worldgen/biomeA\x12minecraft:badlands\x00\x17minecraft:bamboo_jungle\x00\x17minecraft:basalt_deltas\x00\x0fminecraft:beach\x00\x16minecraft:birch_forest\x00\x16minecraft:cherry_grove\x00\x14minecraft:cold_ocean\x00\x18minecraft:crimson_forest\x00\x15minecraft:dark_forest\x00\x19minecraft:deep_cold_ocean\x00\x13minecraft:deep_dark\x00\x1bminecraft:deep_frozen_ocean\x00\x1dminecraft:deep_lukewarm_ocean\x00\x14minecraft:deep_ocean\x00\x10minecraft:desert\x00\x19minecraft:dripstone_caves\x00\x15minecraft:end_barrens\x00\x17minecraft:end_highlands\x00\x16minecraft:end_midlands\x00\x19minecraft:eroded_badlands\x00\x17minecraft:flower_forest\x00\x10minecraft:forest\x00\x16minecraft:frozen_ocean\x00\x16minecraft:frozen_peaks\x00\x16minecraft:frozen_river\x00\x0fminecraft:grove\x00\x14minecraft:ice_spikes\x00\x16minecraft:jagged_peaks\x00\x10minecraft:jungle\x00\x18minecraft:lukewarm_ocean\x00\x14minecraft:lush_caves\x00\x18minecraft:mangrove_swamp\x00\x10minecraft:meadow\x00\x19minecraft:mushroom_fields\x00\x17minecraft:nether_wastes\x00\x0fminecraft:ocean\x00!minecraft:old_growth_birch_forest\x00\x1fminecraft:old_growth_pine_taiga\x00!minecraft:old_growth_spruce_taiga\x00\x15minecraft:pale_garden\x00\x10minecraft:plains\x00\x0fminecraft:river\x00\x11minecraft:savanna\x00\x19minecraft:savanna_plateau\x00\x1bminecraft:small_end_islands\x00\x15minecraft:snowy_beach\x00\x16minecraft:snowy_plains\x00\x16minecraft:snowy_slopes\x00\x15minecraft:snowy_taiga\x00\x1aminecraft:soul_sand_valley\x00\x17minecraft:sparse_jungle\x00\x15minecraft:stony_peaks\x00\x15minecraft:stony_shore\x00\x1aminecraft:sunflower_plains\x00\x0fminecraft:swamp\x00\x0fminecraft:taiga\x00\x11minecraft:the_end\x00\x12minecraft:the_void\x00\x14minecraft:warm_ocean\x00\x17minecraft:warped_forest\x00\x1aminecraft:windswept_forest\x00"minecraft:windswept_gravelly_hills\x00\x19minecraft:windswept_hills\x00\x1bminecraft:windswept_savanna\x00\x19minecraft:wooded_badlands\x00\xe0\x01\x07\x13minecraft:chat_type\x07\x0eminecraft:chat\x00\x17minecraft:emote_command\x00\x1eminecraft:msg_command_incoming\x00\x1eminecraft:msg_command_outgoing\x00\x15minecraft:say_command\x00#minecraft:team_msg_command_incoming\x00#minecraft:team_msg_command_outgoing\x00\xc7\x02\x07\x16minecraft:trim_pattern\x12\x0eminecraft:bolt\x00\x0fminecraft:coast\x00\x0eminecraft:dune\x00\rminecraft:eye\x00\x0eminecraft:flow\x00\x0eminecraft:host\x00\x10minecraft:raiser\x00\rminecraft:rib\x00\x10minecraft:sentry\x00\x10minecraft:shaper\x00\x11minecraft:silence\x00\x0fminecraft:snout\x00\x0fminecraft:spire\x00\x0eminecraft:tide\x00\rminecraft:vex\x00\x0eminecraft:ward\x00\x13minecraft:wayfinder\x00\x0eminecraft:wild\x00\xe3\x01\x07\x17minecraft:trim_material\x0b\x12minecraft:amethyst\x00\x10minecraft:copper\x00\x11minecraft:diamond\x00\x11minecraft:emerald\x00\x0eminecraft:gold\x00\x0eminecraft:iron\x00\x0fminecraft:lapis\x00\x13minecraft:netherite\x00\x10minecraft:quartz\x00\x12minecraft:redstone\x00\x0fminecraft:resin\x00\xb8\x01\x07\x16minecraft:wolf_variant\t\x0fminecraft:ashen\x00\x0fminecraft:black\x00\x12minecraft:chestnut\x00\x0eminecraft:pale\x00\x0fminecraft:rusty\x00\x0fminecraft:snowy\x00\x11minecraft:spotted\x00\x11minecraft:striped\x00\x0fminecraft:woods\x00\x95\x01\x07\x1cminecraft:wolf_sound_variant\x07\x0fminecraft:angry\x00\rminecraft:big\x00\x11minecraft:classic\x00\x0eminecraft:cute\x00\x10minecraft:grumpy\x00\x10minecraft:puglin\x00\rminecraft:sad\x00M\x07\x15minecraft:pig_variant\x03\x0eminecraft:cold\x00\x13minecraft:temperate\x00\x0eminecraft:warm\x00N\x07\x16minecraft:frog_variant\x03\x0eminecraft:cold\x00\x13minecraft:temperate\x00\x0eminecraft:warm\x00\xe9\x01\x07\x15minecraft:cat_variant\x0b\x13minecraft:all_black\x00\x0fminecraft:black\x00\x1bminecraft:british_shorthair\x00\x10minecraft:calico\x00\x10minecraft:jellie\x00\x11minecraft:persian\x00\x11minecraft:ragdoll\x00\rminecraft:red\x00\x11minecraft:siamese\x00\x0fminecraft:tabby\x00\x0fminecraft:white\x00M\x07\x15minecraft:cow_variant\x03\x0eminecraft:cold\x00\x13minecraft:temperate\x00\x0eminecraft:warm\x00Q\x07\x19minecraft:chicken_variant\x03\x0eminecraft:cold\x00\x13minecraft:temperate\x00\x0eminecraft:warm\x00\xc2\x07\x07\x1aminecraft:painting_variant2\x0fminecraft:alban\x00\x0fminecraft:aztec\x00\x10minecraft:aztec2\x00\x12minecraft:backyard\x00\x11minecraft:baroque\x00\x0eminecraft:bomb\x00\x11minecraft:bouquet\x00\x17minecraft:burning_skull\x00\x0eminecraft:bust\x00\x12minecraft:cavebird\x00\x12minecraft:changing\x00\x0fminecraft:cotan\x00\x11minecraft:courbet\x00\x11minecraft:creebet\x00\x15minecraft:donkey_kong\x00\x0fminecraft:earth\x00\x11minecraft:endboss\x00\x0eminecraft:fern\x00\x12minecraft:fighters\x00\x11minecraft:finding\x00\x0eminecraft:fire\x00\x10minecraft:graham\x00\x10minecraft:humble\x00\x0fminecraft:kebab\x00\x11minecraft:lowmist\x00\x0fminecraft:match\x00\x14minecraft:meditative\x00\rminecraft:orb\x00\x12minecraft:owlemons\x00\x11minecraft:passage\x00\x12minecraft:pigscene\x00\x0fminecraft:plant\x00\x11minecraft:pointer\x00\x0eminecraft:pond\x00\x0eminecraft:pool\x00\x16minecraft:prairie_ride\x00\rminecraft:sea\x00\x12minecraft:skeleton\x00\x19minecraft:skull_and_roses\x00\x0fminecraft:stage\x00\x14minecraft:sunflowers\x00\x10minecraft:sunset\x00\x0fminecraft:tid'
]


try:
    payload = Tool.decompress_packet(b'\x03\x03\x80\x02\x1d\x00\x02l\xee\xb4M_q>\xbf\x84\x12\x9d2\x0f\xc0\xb0\xcf\tProficode\x00')
    packet_id, data = Tool.parse_packet(payload)
    print(f"✅ Payload: 0x{packet_id:02x}-{data} {payload == uncompresed[0]}")
except Exception as e:
    print(f"❌ Failed to decompress packet: {e}")
